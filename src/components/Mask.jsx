import { useEffect, useRef, useState } from "react";
import { useSection } from "../context/Context";
import styles from "./Mask.module.css";

const Mask = () => {
  const pathsRef = useRef([]);
  const { cstate, setcstate } = useSection();

  const open = () => {
    setcstate("open");
  };

  useEffect(() => {
    const paths = document.querySelectorAll(`.${styles.mask} path`);

    paths.forEach((path, index) => {
      const length = path.getTotalLength();

      path.style.stroke = "white";
      path.style.strokeWidth = "1";
      path.style.fill = "transparent";

      path.style.strokeDasharray = length;
      path.style.strokeDashoffset = length;

      path.getBoundingClientRect();

      path.style.transition = `
      stroke-dashoffset 1s ease ${index * 0.05}s,
      fill 0.8s ease ${1 + index * 0.05}s
    `;

      path.style.strokeDashoffset = "0";

      setTimeout(() => {
        path.style.fill = "white";
      }, 1000 + index * 50);
    });
  }, [setcstate]);

  return (
    <div
      onClick={open}
      className={`${styles.mask} ${cstate === "open" ? styles.remove : ""}`}
    >
      <svg
        width="180"
        height="180"
        viewBox="0 0 55 48"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          ref={(el) => (pathsRef.current[0] = el)}
          d="M39.1462 20.4494L27.3497 0L0 47.4115H9.12124L23.9937 21.6277C24.7276 20.4307 26.0804 20.4494 26.0804 20.4494H39.1462Z"
          stroke="white"
          strokeWidth="1"
          fill="transparent"
        />
        <path
          ref={(el) => (pathsRef.current[1] = el)}
          d="M37.8691 31.862C39.877 31.667 40.2521 29.8056 40.2521 29.8056C40.1208 30.111 41.6218 25.9304 38.3171 25.9304H29.3084C29.3084 25.9304 28.8348 25.9228 28.5763 26.3432L16.4258 47.4115H54.6975L45.5063 31.4749C45.5063 31.4749 44.4335 36.7713 38.7254 37.322H27.4837L30.6344 31.8615L37.8691 31.862Z"
          stroke="white"
          strokeWidth="1"
          fill="transparent"
        />
      </svg>
      <svg
        width="195"
        height="30"
        viewBox="0 0 113 15"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M3.97656 0.203125H6.03125L10.0078 11.3125H8.25L7.03906 7.96875H3.9375L4.53125 6.32812H6.44531L5.00781 2.35938L1.75781 11.3125H0L3.97656 0.203125ZM11.2656 4.85938C11.2656 4.40625 11.4271 4.02083 11.75 3.70312C12.0781 3.38021 12.4714 3.21875 12.9297 3.21875H15.7812C16.3177 3.21875 16.8073 3.35156 17.25 3.61719C17.6927 3.8776 18.0443 4.22917 18.3047 4.67188C18.5703 5.11458 18.7031 5.60417 18.7031 6.14062V11.3125H17.0547V6.16406C17.0547 5.79948 16.9297 5.48958 16.6797 5.23438C16.4349 4.97917 16.1354 4.85156 15.7812 4.85156H12.9141V11.3125H11.2656V4.85938ZM20.5 6.14062C20.5 5.60417 20.6354 5.11458 20.9062 4.67188C21.1771 4.22917 21.5391 3.8776 21.9922 3.61719C22.4453 3.35156 22.9479 3.21875 23.5 3.21875H28.0547V4.86719H23.5C23.1302 4.86719 22.8125 4.99479 22.5469 5.25C22.2812 5.5 22.1484 5.80469 22.1484 6.16406V8.35938C22.1484 8.71875 22.2786 9.02604 22.5391 9.28125C22.8047 9.53646 23.125 9.66406 23.5 9.66406H28.0547V11.3125H23.5C22.9479 11.3125 22.4453 11.1797 21.9922 10.9141C21.5391 10.6484 21.1771 10.2943 20.9062 9.85156C20.6354 9.40365 20.5 8.91146 20.5 8.375V6.14062ZM29.6719 1.01562C29.6719 0.734375 29.7708 0.494792 29.9688 0.296875C30.1667 0.0989583 30.4062 0 30.6875 0C30.9688 0 31.2083 0.0989583 31.4062 0.296875C31.6042 0.494792 31.7031 0.734375 31.7031 1.01562C31.7031 1.29688 31.6042 1.53646 31.4062 1.73438C31.2083 1.93229 30.9688 2.03125 30.6875 2.03125C30.4062 2.03125 30.1667 1.93229 29.9688 1.73438C29.7708 1.53646 29.6719 1.29688 29.6719 1.01562ZM29.8594 3.21875H31.5156V11.3125H29.8594V3.21875ZM33.3906 0.203125H35.0391V11.3125H33.3906V0.203125ZM36.9219 0.203125H38.5703V11.3125H36.9219V0.203125ZM40.375 6.125C40.375 5.58854 40.5052 5.10156 40.7656 4.66406C41.0312 4.22656 41.3854 3.8776 41.8281 3.61719C42.2708 3.35156 42.7604 3.21875 43.2969 3.21875H47.8125V11.3125H46.1641V4.86719H43.2969C42.9479 4.86719 42.6484 4.99219 42.3984 5.24219C42.1484 5.48698 42.0234 5.78646 42.0234 6.14062V8.375C42.0234 8.72917 42.1484 9.03385 42.3984 9.28906C42.6484 9.53906 42.9479 9.66406 43.2969 9.66406H45.2266V11.3125H43.2969C42.7604 11.3125 42.2708 11.1823 41.8281 10.9219C41.3854 10.6562 41.0312 10.3021 40.7656 9.85938C40.5052 9.41667 40.375 8.92708 40.375 8.39062V6.125ZM49.6875 5.48438C49.6875 5.06771 49.7917 4.6875 50 4.34375C50.2135 4 50.4948 3.72656 50.8438 3.52344C51.1979 3.32031 51.5885 3.21875 52.0156 3.21875H53.8203V4.85938H52.0156C51.8281 4.85938 51.6667 4.92448 51.5312 5.05469C51.401 5.17969 51.3359 5.33333 51.3359 5.51562V11.3125H49.6875V5.48438ZM56.5938 3.21875L58.6953 8.82812L60.8438 3.21875H62.6641L58.3672 14.3594H56.5625L57.8203 11.0469L54.8438 3.21875H56.5938ZM68.4531 0.203125H74.3281C74.8333 0.203125 75.2917 0.328125 75.7031 0.578125C76.1198 0.822917 76.4505 1.15104 76.6953 1.5625C76.9453 1.97396 77.0703 2.43229 77.0703 2.9375V4.04688C77.0703 4.54167 76.9453 4.99479 76.6953 5.40625C76.4505 5.8125 76.1198 6.13802 75.7031 6.38281C75.2917 6.6224 74.8333 6.74219 74.3281 6.74219H71.0391V5.10156H74.3281C74.6354 5.10156 74.8958 4.9974 75.1094 4.78906C75.3229 4.58073 75.4297 4.32552 75.4297 4.02344V2.9375C75.4297 2.63542 75.3229 2.3776 75.1094 2.16406C74.8958 1.95052 74.6354 1.84375 74.3281 1.84375H70.1016V11.3125H68.4531V0.203125ZM78.4375 6.14062C78.4375 5.60417 78.5677 5.11458 78.8281 4.67188C79.0938 4.22917 79.4479 3.8776 79.8906 3.61719C80.3333 3.35156 80.8229 3.21875 81.3594 3.21875H83.125C83.6615 3.21875 84.151 3.35156 84.5938 3.61719C85.0365 3.8776 85.388 4.22917 85.6484 4.67188C85.9141 5.11458 86.0469 5.60417 86.0469 6.14062V8.39062C86.0469 8.92708 85.9141 9.41667 85.6484 9.85938C85.388 10.3021 85.0365 10.6562 84.5938 10.9219C84.151 11.1823 83.6615 11.3125 83.125 11.3125H81.3594C80.8229 11.3125 80.3333 11.1823 79.8906 10.9219C79.4479 10.6562 79.0938 10.3021 78.8281 9.85938C78.5677 9.41667 78.4375 8.92708 78.4375 8.39062V6.14062ZM80.0859 8.375C80.0859 8.72917 80.2109 9.03385 80.4609 9.28906C80.7109 9.53906 81.0104 9.66406 81.3594 9.66406H83.125C83.4792 9.66406 83.7786 9.53906 84.0234 9.28906C84.2734 9.03385 84.3984 8.72917 84.3984 8.375V6.15625C84.3984 5.80208 84.2734 5.5 84.0234 5.25C83.7786 4.99479 83.4792 4.86719 83.125 4.86719H81.3594C81.0104 4.86719 80.7109 4.99479 80.4609 5.25C80.2109 5.5 80.0859 5.80208 80.0859 6.15625V8.375ZM89.0312 3.21875L89.9609 8.57812L91.9609 5.16406H93.5156L95.5156 8.57812L96.4453 3.21875H98.0938L96.6953 11.3125H95.25L92.7422 7.07031L90.2266 11.3125H88.7812L87.375 3.21875H89.0312ZM99.5 4.89062C99.5 4.42708 99.6693 4.03385 100.008 3.71094C100.346 3.38281 100.753 3.21875 101.227 3.21875H104.602C105.034 3.21875 105.424 3.32552 105.773 3.53906C106.128 3.7474 106.409 4.03125 106.617 4.39062C106.831 4.74479 106.938 5.13802 106.938 5.57031V5.79688C106.938 6.22396 106.831 6.61458 106.617 6.96875C106.409 7.31771 106.128 7.59896 105.773 7.8125C105.424 8.02083 105.034 8.125 104.602 8.125H102.086V6.48438H104.617C104.805 6.48438 104.964 6.41667 105.094 6.28125C105.229 6.14583 105.297 5.98177 105.297 5.78906V5.57031C105.297 5.3724 105.229 5.20573 105.094 5.07031C104.964 4.9349 104.805 4.86719 104.617 4.86719H101.148V9.02344C101.148 9.20052 101.208 9.35156 101.328 9.47656C101.448 9.60156 101.594 9.66406 101.766 9.66406H106.367V11.3125H101.766C101.349 11.3125 100.969 11.2109 100.625 11.0078C100.281 10.7995 100.008 10.5234 99.8047 10.1797C99.6016 9.83073 99.5 9.44792 99.5 9.03125V4.89062ZM108.734 5.48438C108.734 5.06771 108.839 4.6875 109.047 4.34375C109.26 4 109.542 3.72656 109.891 3.52344C110.245 3.32031 110.635 3.21875 111.062 3.21875H112.867V4.85938H111.062C110.875 4.85938 110.714 4.92448 110.578 5.05469C110.448 5.17969 110.383 5.33333 110.383 5.51562V11.3125H108.734V5.48438Z"
          fill="white"
        />
      </svg>
    </div>
  );
};

export default Mask;
